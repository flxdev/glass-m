function Menu(){var e=$(".js-menu"),t=$(".mob-menu"),o="active",n="menu-open";e.add(t).on("click",function(i){if(!e.hasClass("anim")){if(e.addClass("anim"),e.hasClass(o)){var a=$(".mob-menu-inner");a.is(i.target)||0!==a.has(i.target).length||(setTimeout(function(){e.removeClass(o)},400),t.removeClass(o),conf.body.removeClass(n),window.__prevScrollTop&&window.scroll(0,window.__prevScrollTop),window.__prevScrollTop=null)}else{var r=$(window).scrollTop();window.__prevScrollTop=r,e.addClass(o),conf.body.addClass(n),t.addClass(o),document.body.style.top=-r+"px",window.scroll(0,window.__prevScrollTop)}setTimeout(function(){e.removeClass("anim")},500)}})}function scaleVideoContainer(){var e=$(".video-container").height()+5,t=parseInt(e)+"px";$(".homepage-hero-module").css("height",t)}function initBannerVideoSize(e){$(e).each(function(){$(this).data("height",$(this).height()),$(this).data("width",$(this).width())}),scaleBannerVideoSize(e)}function scaleBannerVideoSize(e){var t,o,n=$(".video-container").width(),i=$(".video-container").outerHeight()+5;$(e).each(function(){var e=$(this).data("height")/$(this).data("width");$(this).width(n),n<1e3&&(o=i,t=o/e,$(this).css({"margin-top":0,"margin-left":-(t-n)/2+"px"}),$(this).width(t).height(o)),$(".homepage-hero-module .video-container video").addClass("fadeIn animated")})}function SearchForm(e){var t=this;t.initEvents=function(){t.el.on("focus",t.iFocus),t.el.on("blur",function(e){$(e.relatedTarget).hasClass("search-submit")||t.iBlur()}),t.el.on("input",t.iInput),t.submit.on("click",t.initSubmit),t.reset.on("click",t.iReset),this.el.on("click",function(){var e=$(this);e.removeAttr("readonly"),setTimeout(function(){e.trigger("change click"),e.focus()},500)})},t.iInput=function(){t.iVal=$(this).val(),0!=t.iVal?(t.reset.addClass(t.def.resetClass),t.form.addClass(t.def.active),t.placeHold.hide()):(t.reset.removeClass(t.def.resetClass),t.form.removeClass(t.def.active),t.placeHold.show())},t.iFocus=function(){t.iVal=t.el.val(),t.parent.addClass(t.def.open),t.submit.attr("type","submit"),0!=t.iVal.length&&t.form.addClass(t.def.active)},t.iBlur=function(){t.iVal=t.el.val(),0==t.iVal.length&&(t.parent.removeClass(t.def.open),t.submit.attr("type","button"))},t.iReset=function(){t.reset.removeClass(t.def.resetClass),t.form.removeClass(t.def.active),t.submit.attr("type","button"),t.el.attr("value",""),t.el.val(""),t.el.focus(),t.placeHold.show()},t.initSubmit=function(){return"submit"!==t.submit.attr("type")?t.el.trigger("focus"):alert("Send form!"),!1},t.iDetected=function(e){0!=t.iVal.length&&(t.iFocus(),t.reset.addClass(t.def.resetClass),t.placeHold.hide())},t.generatePlaceeholder=function(){var e=document.createElement("span");e.classList.add("placeholder");var o=this.el.data("placeholder");e.textContent=o,$(e).insertAfter(this.el),t.placeHold=$(".placeholder")},t.init=function(){t.el=e,t.parent=t.el.parent(),t.iVal=t.el.val(),t.submit=t.parent.find(".search-submit"),t.reset=t.parent.find(".search-reset"),t.form=t.el.parents("form"),t.def={open:"open",resetClass:"show",active:"not-empty"},t.generatePlaceeholder(),t.iDetected(),t.initEvents()},e.length&&t.init()}function promoslider(){$(".js-promoslider").each(function(){var e=$(this),t=e.closest(".promo-slider"),o=e.find(".promo-slider-item"),n=t.find(".js-promo-link");e.on("init reInit afterChange",function(e,t,i,a){var r=o.filter(".slick-current"),s=r.data("href");n.attr("href",s)}),e.slick({accessibility:!1,arrows:!0,dots:!0,fade:!0,touchMove:!1,dragable:!1,infinite:!0,slidesToShow:1,slidesToScroll:1,appendDots:t.find(".dots-wrap"),speed:1e3})})}function lazyImage(){function e(e){return new Promise(function(t,o){var n=new Image;n.src=e,n.onload=t,n.onerror=o})}function t(t){var o=t.dataset.src;if(o)return e(o).then(function(){n(t,o)})}function o(e){0===l&&c.disconnect(),e.forEach(function(e){e.intersectionRatio>0&&(l--,c.unobserve(e.target),t(e.target))})}function n(e,t){e.classList.add("js-image-handled"),e.classList.contains("bg")?e.style.backgroundImage="url("+t+")":e.src=t,e.classList.add("fade-in")}for(var i=document.querySelectorAll(".js-image"),a=[],r=0;r<i.length;r++)a.push(i[r]);var s={rootMargin:"0px 0px",threshold:.01},l=a.length,c=void 0;if("IntersectionObserver"in window){c=new IntersectionObserver(o,s);for(var r=0;r<l;r++){if(a[r].classList.contains("js-image-handled"))return;c.observe(a[r])}}else for(var r=0;r<l;r++)t(a[r])}function Ytube(){for(var e=document.querySelectorAll(".youtube-slide"),t=0;t<e.length;t++){var o="https://img.youtube.com/vi/"+e[t].dataset.embed+"/mqdefault.jpg",n=$(e[t]).parent(),i=new Image;i.src=o,i.addEventListener("load",function(){e[t].appendChild(i)}(t)),e[t].addEventListener("click",function(){var e=document.createElement("iframe");e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen",""),n.hasClass("prod-eleminner-images")?e.setAttribute("src","https://www.youtube.com/embed/"+this.dataset.embed+"?wmode=opaque&rel=0&showinfo=0&autoplay=1"):e.setAttribute("src","https://www.youtube.com/embed/"+this.dataset.embed+"?rel=0&showinfo=0"),this.innerHTML="",this.appendChild(e)})}}function teamslider(){$(".js-team-slider").each(function(){var e=$(this);e.parent();e.slick({accessibility:!1,arrows:!1,dots:!1,fade:!1,touchMove:!1,dragable:!1,infinite:!0,slidesToShow:2,slidesToScroll:1})})}function qualitySlider(){$(".js-quality-slider").each(function(){var e=$(this);e.parent();e.slick({accessibility:!1,arrows:!1,dots:!1,fade:!1,touchMove:!1,dragable:!1,infinite:!0,slidesToShow:2,slidesToScroll:1})})}function moreslider(){$(".js-moreslider").each(function(){var e=$(this),t=e.parent();e.slick({accessibility:!1,arrows:!0,dots:!1,fade:!1,touchMove:!1,dragable:!1,infinite:!1,slidesToShow:1,slidesToScroll:1,appendArrows:t.find(".slider-nav"),prevArrow:conf.arnprevcontent,nextArrow:conf.arnextcontent})})}function ProjectsSlider(){$(".js-project-slider").each(function(){var e=$(this),t=e.closest(".projects-wrap");e.slick({accessibility:!1,arrows:!1,dots:!0,touchMove:!1,dragable:!1,infinite:!0,slidesToShow:1,autoplaySpeed:4500,autoplay:!0,vertical:!0,slidesToScroll:1,asNavFor:t.find(".js-project-bg"),appendDots:t.find(".dots-wrap")})}),$(".js-project-bg").each(function(){var e=$(this),t=e.closest(".projects-wrap");e.slick({accessibility:!1,arrows:!1,dots:!1,fade:!0,touchMove:!1,dragable:!1,infinite:!1,autoplaySpeed:4500,slidesToShow:1,slidesToScroll:1,asNavFor:t.find(".js-project-slider")})})}function feedbackslider(){$(".js-feedbackslider-main").each(function(){var e=$(this),t=e.parent();e.slick({accessibility:!1,arrows:!0,dots:!1,fade:!0,touchMove:!1,dragable:!1,infinite:!1,slidesToShow:1,speed:1e3,slidesToScroll:1,asNavFor:t.find(".js-feedbackslider-bg"),appendArrows:t.find(".slider-nav"),prevArrow:conf.arnprevcontent,nextArrow:conf.arnextcontent})}),$(".js-feedbackslider-bg").each(function(){var e=$(this),t=e.parent();e.slick({accessibility:!1,arrows:!1,dots:!1,fade:!0,touchMove:!1,dragable:!1,infinite:!1,speed:1e3,slidesToShow:1,slidesToScroll:1,asNavFor:t.find(".js-feedbackslider-main")})})}function scrollAnimations(){inView.offset({top:0,bottom:40}),inView.threshold(.1);document.querySelectorAll(".anim-cont");inView(".anim-cont").on("enter",function(e){e.done||e.classList.add("active")}).on("exit",function(e){e.done=!0}),inView(".projects-wrap").on("enter",function(e){e.done||e.classList.add("active")}).on("exit",function(e){e.done=!0})}function review(e){this.elems=$(e),this.modal=$('[data-modal="review"]'),this.targetcont=this.modal.find(".js-review-target"),this.height=123,this.checkheight()}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var i=o[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}function urldecode(e){return decodeURIComponent(e.replace(/\+/g," "))}function getString(e){return decodeURIComponent(e.replace(/\+/g," "))}function ProdinnerHead(){var e=$(".js-prod-head"),t=e.find(".columns:last-child").find(".prod-nav-link"),o=(t.find(".prod-nav-link-text"),e.find(".columns:first-child").find(".prod-nav-link")),n=(o.find(".prod-nav-link-text"),$(".page-head").height(),$(".barba-container").last(),null!==getCookie("BITRIX_SM_MAIN_CUR_DIR")&&getCookie("BITRIX_SM_MAIN_CUR_DIR").toUpperCase()),i=getCookie("BITRIX_SM_"+n+"_NEXT_LINK"),a=(getCookie("BITRIX_SM_"+n+"_NEXT_TEXT"),getCookie("BITRIX_SM_"+n+"_PREV_LINK"));getCookie("BITRIX_SM_"+n+"_PREV_TEXT");null!==i?t.attr("href",urldecode(i)):t.attr("href","#"),null!==a?o.attr("href",urldecode(a)):o.attr("href","#"),e.addClass("active")}function initMap(){var e=$("#map");opts={zoom:12,fullscreenControl:!0,scrollwheel:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,gestureHandling:"cooperative",zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER},styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#ffffff"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"simplified"},{color:"#377041"},{lightness:"79"},{saturation:"0"}]},{featureType:"poi.attraction",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45},{visibility:"simplified"},{color:"#f0f0f0"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"road",elementType:"labels.text",stylers:[{color:"#b0b0b0"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"simplified"},{color:"#b0b0b0"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"simplified"},{lightness:"29"},{saturation:"9"}]},{featureType:"transit",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.text",stylers:[{visibility:"simplified"},{lightness:"0"},{saturation:"0"},{gamma:"3.84"},{color:"#5d5353"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"on"}]},{featureType:"water",elementType:"all",stylers:[{color:"#cadfe7"},{visibility:"on"}]}]},initialize(e[0])}function initialize(e){var t=e,o=parseFloat(t.getAttribute("data-lat")),n=parseFloat(t.getAttribute("data-lon")),i=t.getAttribute("data-icon"),a=new google.maps.LatLng(o,n);mapvar=new google.maps.Map(t,opts),mapvar.setCenter(a);var r={url:i,size:new google.maps.Size(53,85),origin:new google.maps.Point(0,0),scaledSize:new google.maps.Size(26.5,42.5),anchor:new google.maps.Point(13.25,21.25)};new google.maps.Marker({position:a,map:mapvar,icon:r,zIndex:99999});e.classList.add("inited")}function googleMaps(){var e=document.createElement("script");"object"!=typeof google?(e.setAttribute("type","text/javascript"),e.setAttribute("src","https://maps.googleapis.com/maps/api/js?key=AIzaSyDcFkgUmSnM7fy40cDnRn8BB_xu1cp7Ros&callback=initMap"),document.getElementById("map").appendChild(e)):initialize(document.getElementById("map"))}function scrollToEl(){$(".js-scroll-to").on("click",function(e){e.preventDefault(),e.stopPropagation();var t,o=$(this).data("href"),n=$("body").find('[data-id="'+o+'"]'),i=80;$(this).hasClass("to-top")&&(t=0,$("html, body:not(:animated), .out:not(:animated)").animate({scrollTop:t},600)),n.length&&(t=$(n).offset().top,$("html, body:not(:animated), .out:not(:animated)").animate({scrollTop:t-i},600))})}function loadState(){var e=window.location.pathname,t=document.querySelectorAll('[href="'+e+'"]'),o=document.querySelectorAll(".js-nav");Array.prototype.forEach.call(o,function(e){return e.classList.remove("active")}),Array.prototype.forEach.call(t,function(e){return e.classList.add("active")})}function tapProject(){var e=$(".row-blue");if(e.length){var t=e.find(".project-item");t.each(function(){var o=$(this);o.off("click").on("click",function(){o.hasClass("showed")||o.addClass("showed").parent().siblings().find(".project-item").removeClass("showed"),$(document).on("click",function(o){e.is(o.target)||0!==e.has(o.target).length||t.removeClass("showed")})})})}}$(window).on("load",function(){lazyImage(),loadState()}),document.addEventListener("DOMContentLoaded",function(){function e(){$(".video-container").length&&(scaleVideoContainer(),initBannerVideoSize(".video-container .poster img"),initBannerVideoSize(".video-container .filter"),initBannerVideoSize(".video-container video"),$(window).on("resize",function(){scaleVideoContainer(),scaleBannerVideoSize(".video-container .poster img"),scaleBannerVideoSize(".video-container .filter"),scaleBannerVideoSize(".video-container video")}))}Menu();new SearchForm($(".js-input"));promoslider(),e(),scrollAnimations(),scrollToEl()});var conf={body:$("body"),html:$("html"),hidden:"is-hidden",main:$("#barba-wrapper"),wrpr:$(".block"),footer:$(".footer"),arnextcontent:'<button type="button" class="slick-next slick-arrow"><div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.5 40.1"><style>.starrs0{fill:#1E3E7C;}</style><path d="M4.6 20.4c-.1-.1-.1-.2-.1-.3 0-.1 0-.2.1-.3L19.3 2.6l-.2-.2.2.2c.2-.2.2-.4.2-.6 0-.3-.1-.6-.3-.7L18 .3c-.2-.2-.4-.3-.6-.3-.3 0-.6.1-.7.3L.2 19.4c-.1.2-.2.4-.2.7 0 .2.1.5.2.6l16.4 19.1c.2.2.5.3.7.3.2 0 .5-.1.6-.2l1.2-1c.2-.2.3-.5.3-.7 0-.2-.1-.5-.2-.6L4.6 20.4z" class="starrs0"/></svg></div></button>',arnprevcontent:'<button type="button" class="slick-prev slick-arrow"><div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.5 40.1"><style>.starrs0{fill:#1E3E7C;}</style><path d="M4.6 20.4c-.1-.1-.1-.2-.1-.3 0-.1 0-.2.1-.3L19.3 2.6l-.2-.2.2.2c.2-.2.2-.4.2-.6 0-.3-.1-.6-.3-.7L18 .3c-.2-.2-.4-.3-.6-.3-.3 0-.6.1-.7.3L.2 19.4c-.1.2-.2.4-.2.7 0 .2.1.5.2.6l16.4 19.1c.2.2.5.3.7.3.2 0 .5-.1.6-.2l1.2-1c.2-.2.3-.5.3-.7 0-.2-.1-.5-.2-.6L4.6 20.4z" class="starrs0"/></svg></div></button>',firstLoad:!1};window.Promise||(window.Promise=Promise),function(){return"function"!=typeof NodeList.prototype.forEach&&void(NodeList.prototype.forEach=Array.prototype.forEach)}(),review.prototype={checkheight:function(){var e=this;this.elems.each(function(){var t=$(this).find(".review-item-inner"),o=t.find(".js-review-text"),n=o.height();n>e.height&&(t.addClass("cutted"),e.initclick($(this)))})},initclick:function(e){var t=this,o=e.find(".review-trigger");o.off("click").on("click",function(){var e=$(this).closest(".review-item-inner");t.targetcont.empty(),e.clone().appendTo(t.targetcont).removeClass("cutted"),t.openModal()})},openModal:function(){var e=this;this.modal.addClass("active");var t=$(window).scrollTop();window.__prevScrollTop=t,document.body.style.top=-t+"px",window.scroll(0,window.__prevScrollTop),conf.body.addClass("menu-open"),this.modal.find().add(this.modal).off("click").on("click",function(t){var o=$(".modal-container");(!o.is(t.target)&&0===o.has(t.target).length||$(".closePopup").is(t.target))&&e.closeModal()})},closeModal:function(){this.modal.removeClass("active"),conf.body.removeClass("menu-open"),window.__prevScrollTop&&window.scroll(0,window.__prevScrollTop),window.__prevScrollTop=null}};var debounce=function(e,t,o){var n;return function(){var i=this,a=arguments,r=function(){n=null,o||e.apply(i,a)},s=o&&!n;clearTimeout(n),n=setTimeout(r,t),s&&e.apply(i,a)}},sortItem=function(){var e=$(".js-select-item");e.each(function(){var t=$(this),o=t.find(".js-trgt-text"),n=t.parent().find(".dropdown-target"),i=n.find(".sort-select-item a");t.on("click",function(){e.removeClass("active"),t.toggleClass("active")}),i.each(function(){var t=$(this);t.on("click",function(i){var a=t.data("text");o.text(a),t.parent().addClass("active").siblings().removeClass("active"),i.preventDefault(),setTimeout(function(){n.removeClass("active"),e.removeClass("active")},300)})}),$(document).on("click touchstart",function(t){e.is(t.target)||0!==e.has(t.target).length||e.removeClass("active")})})},opts,BarbaWitget={init:function(){var e=this;Barba.Pjax.start(),Barba.Pjax.cacheEnabled=!1,Barba.Pjax.getTransition=function(){return e.MovePage},Barba.Dispatcher.on("newPageReady",function(e){var t=e.url.split(window.location.origin)[1].substring(0),o=document.querySelectorAll(".js-nav"),n=document.querySelectorAll('[href="'+t+'"]');Array.prototype.forEach.call(o,function(e){return e.classList.remove("active")}),Array.prototype.forEach.call(n,function(e){return e.classList.add("active")})}),Barba.Dispatcher.on("transitionCompleted",function(e,t){scrollAnimations(),lazyImage(),scrollToEl()})},MovePage:Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.fadeOut()]).then(this.fadeIn.bind(this))},fadeOut:function(){Barba.Utils.deferred();return $(".js-menu").add(".mob-menu").removeClass("active"),conf.body.removeClass("menu-open"),window.__prevScrollTop&&window.scroll(0,window.__prevScrollTop),window.__prevScrollTop=null,$(this.oldContainer).animate({opacity:0},1e3,function(){}).addClass("moveDown").promise()},fadeIn:function(){var e=this,t=$(this.newContainer);$(this.oldContainer).hide(),t.addClass("moveUp"),TweenMax.set(t,{force3D:!0,y:200,onComplete:function(){$(window).scrollTop(0,0),TweenMax.to(t,.5,{y:0,force3D:!0,autoAlpha:1,onComplete:function(){TweenMax.set(t,{clearProps:"all"}),t.removeClass("moveUp"),e.done()}})}})}})},IndexPage=Barba.BaseView.extend({namespace:"index",onEnter:function(){promoslider(),ProjectsSlider()},onEnterCompleted:function(){teamslider()},onLeaveComplete:function(){}}),Production=Barba.BaseView.extend({namespace:"Production",onEnter:function(){},onEnterCompleted:function(){console.log("onEnterCompleted")},onLeaveComplete:function(){console.log("onLeaveComplete")}}),ProductionInner=Barba.BaseView.extend({namespace:"Production-inner",onEnter:function(){Ytube()},onLeave:function(){$(".js-prod-head").removeClass("active")},onEnterCompleted:function(){moreslider(),ProdinnerHead()},onLeaveComplete:function(){}}),PojectsPage=Barba.BaseView.extend({namespace:"Projects",onEnter:function(){},onEnterCompleted:function(){sortItem()},onLeaveComplete:function(){}}),contacts=Barba.BaseView.extend({namespace:"Contacts",onEnter:function(){},onEnterCompleted:function(){googleMaps()},onLeaveComplete:function(){}}),content=Barba.BaseView.extend({namespace:"Content",onEnter:function(){tapProject();var e=document.querySelectorAll(".review-item");e.length&&(revfunc=new review(e))},onEnterCompleted:function(){feedbackslider()},onLeaveComplete:function(){}}),NewsInner=Barba.BaseView.extend({namespace:"news-inner",onEnter:function(){},onLeave:function(){},onEnterCompleted:function(){stickinit(),moreslider()},onLeaveComplete:function(){}});IndexPage.init(),Production.init(),ProductionInner.init(),PojectsPage.init(),contacts.init(),content.init(),NewsInner.init(),BarbaWitget.init();